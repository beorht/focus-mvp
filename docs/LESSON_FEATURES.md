# Новые функции для страницы обучения

## Обзор

Были добавлены следующие функции для улучшения процесса обучения:

1. **Автоматический перевод материалов** - при смене языка материалы урока автоматически переводятся
2. **Интерактивные тесты** - квизы с автопроверкой и объяснениями
3. **Сохранение/Загрузка ответов** - возможность экспортировать и импортировать ответы на тесты
4. **Рефлексия** - система самооценки и записи выводов после прохождения темы

## 1. Автоматический перевод материалов

### API Endpoint: `/api/translate`

**Как работает:**
- При изменении языка в приложении (ru → uz-cyrl → uz-latn)
- Автоматически отправляется запрос на перевод всего контента урока
- Использует Gemini 2.0 Flash для качественного перевода
- Сохраняет оригинальную структуру JSON

**Технические детали:**
- Переводит: profession, topics (title, summary, examples, tasks, quiz)
- Показывает индикатор загрузки во время перевода
- Поддерживает ротацию API ключей при превышении квоты

## 2. Интерактивные тесты (QuizSection)

### Структура данных для квиза

```json
{
  "quiz": {
    "title": "Проверка знаний: Основы React",
    "description": "Проверьте свое понимание основ React",
    "questions": [
      {
        "question": "Что такое JSX?",
        "options": [
          "Язык программирования",
          "Синтаксическое расширение JavaScript",
          "Библиотека для стилизации",
          "Фреймворк для тестирования"
        ],
        "correctAnswer": 1,
        "explanation": "JSX - это синтаксическое расширение JavaScript, которое позволяет писать HTML-подобный код в JavaScript файлах."
      },
      {
        "question": "Для чего используется useState?",
        "options": [
          "Для создания компонентов",
          "Для управления состоянием компонента",
          "Для маршрутизации",
          "Для работы с API"
        ],
        "correctAnswer": 1,
        "explanation": "useState - это React Hook для управления локальным состоянием функционального компонента."
      }
    ]
  }
}
```

### Функциональность:

- ✅ Пошаговое прохождение вопросов
- ✅ Визуальная индикация правильных/неправильных ответов
- ✅ Объяснения к каждому вопросу
- ✅ Подсчет результатов (баллы и процент)
- ✅ Экспорт ответов в JSON
- ✅ Импорт ранее сохраненных ответов
- ✅ Автосохранение в localStorage
- ✅ Кнопка сброса для повторного прохождения

## 3. Сохранение/Загрузка ответов

### Экспорт ответов

При нажатии кнопки "Download" создается JSON файл:

```json
{
  "topicTitle": "Основы React",
  "quiz": "Проверка знаний: Основы React",
  "answers": [
    {
      "question": "Что такое JSX?",
      "selectedOption": "Синтаксическое расширение JavaScript",
      "correctOption": "Синтаксическое расширение JavaScript",
      "isCorrect": true
    }
  ],
  "score": 8,
  "timestamp": "2025-12-13T10:30:00.000Z"
}
```

### Импорт ответов

- Нажмите кнопку "Upload"
- Выберите ранее сохраненный JSON файл
- Ответы автоматически восстановятся

## 4. Рефлексия (ReflectionSection)

### Поля для заполнения:

1. **Понимание материала** (1-5 звезд) - самооценка усвоения
2. **Сложность темы** (1-5 звезд) - насколько сложной была тема
3. **Уверенность** (1-5 звезд) - уровень уверенности в знаниях
4. **Время изучения** - сколько часов/минут потрачено
5. **Ключевые выводы** - основные идеи, которые усвоены
6. **Вопросы** - что осталось неясным
7. **Практическое применение** - как планируете использовать знания

### Функциональность:

- ✅ Автосохранение в localStorage
- ✅ Экспорт рефлексии в JSON
- ✅ Визуальная индикация сохранения
- ✅ Timestamp последнего сохранения

## Интеграция в существующий проект

### Шаг 1: Добавьте квиз в данные урока

При генерации roadmap через `/api/generate`, добавьте квиз в структуру topic:

```javascript
{
  "topics": [
    {
      "title": "Основы React",
      "summary": "...",
      "hours": 10,
      "examples": [...],
      "tasks": [...],
      "quiz": {
        "title": "Проверка знаний",
        "questions": [...]
      }
    }
  ]
}
```

### Шаг 2: Компоненты автоматически рендерятся

На странице `/lesson`:
- Если есть `quiz` - отображается QuizSection
- ReflectionSection отображается всегда для каждой темы

### Шаг 3: Используйте перевод

При смене языка через переключатель в UI:
- Материалы автоматически переводятся
- Показывается индикатор "Перевод..."
- Сохраняется оригинал для возврата к русскому языку

## Хранение данных

### localStorage ключи:

- `quiz_{topicTitle}` - ответы на квиз
- `reflection_{topicTitle}` - данные рефлексии
- `progress_{profession}` - отмеченные как завершенные темы

### sessionStorage ключи:

- `selectedLesson` - текущий выбранный урок

## Примеры использования

### 1. Добавить квиз в API generate

Обновите промпт в `/api/generate/route.ts`:

```javascript
const prompt = `
...
For each topic in the roadmap, include:
- title
- summary
- hours
- examples (array of strings)
- tasks (array of {title, description})
- quiz (optional): {
    title: string,
    description: string,
    questions: [{
      question: string,
      options: string[],
      correctAnswer: number (0-3),
      explanation: string
    }]
  }
...
`
```

### 2. Тестирование перевода

```javascript
// Пример запроса к /api/translate
fetch('/api/translate', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    content: {
      profession: "Frontend Developer",
      topics: [...]
    },
    targetLanguage: 'uz-cyrl'
  })
})
```

## Преимущества

1. **Геймификация** - квизы делают обучение интерактивным
2. **Самоанализ** - рефлексия помогает закреплять знания
3. **Мультиязычность** - автоперевод для узбекских пользователей
4. **Прогресс** - сохранение ответов и рефлексий для отслеживания роста
5. **Портативность** - экспорт/импорт данных в JSON

## Будущие улучшения

- [ ] Добавить AI-генерацию квизов на основе материала темы
- [ ] Интеграция с Gemini для оценки ответов на открытые вопросы
- [ ] Статистика прогресса по всем темам
- [ ] Социальный шеринг результатов
- [ ] Адаптивные квизы (сложность зависит от уровня пользователя)
